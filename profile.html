<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Profile - Ukno Club</title>
    <link rel="stylesheet" href="profile.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="profile-container">
        <header class="profile-header">
            <div class="branding">
                <img src="assets/logo.png" alt="Ukno Club" class="logo">
                <h1>Minimal Profile Page</h1>
            </div>
            <nav class="user-nav">
                <a href="dashboard.html">Dashboard</a>
                <a href="auth.html" class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </nav>
        </header>

        <main class="profile-content">
            <section class="profile-section">
                <h2>Authentication Check Result</h2>
                <p id="authStatusMessage">Checking authentication...</p>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const authStatusMessage = document.getElementById('authStatusMessage');

            // --- localStorage/sessionStorage Keys (Consistent with auth.html & dashboard.html) ---
            const ADMIN_AUTH_KEY = 'adminAuthenticated';
            // LOGGED_IN_USERNAME_KEY is not needed for just the auth check

            // --- Authentication Check for Protected Page ---
            // This runs when the page loads to ensure the user is authenticated using primary flags
            const userAuthLocal = localStorage.getItem('userAuthenticated') === 'true';
            const userAuthSession = sessionStorage.getItem('userAuthenticated') === 'true';
            const adminAuthLocal = localStorage.getItem(ADMIN_AUTH_KEY) === 'true';

            console.log("--- Minimal Profile.html Auth Check ---");
            console.log("localStorage userAuthenticated:", localStorage.getItem('userAuthenticated'), "->", userAuthLocal);
            console.log("sessionStorage userAuthenticated:", sessionStorage.getItem('userAuthenticated'), "->", userAuthSession);
            console.log("localStorage adminAuthenticated:", localStorage.getItem(ADMIN_AUTH_KEY), "->", adminAuthLocal);


            // If neither user nor admin authentication flag is found, redirect to login page
            if (!userAuthLocal && !userAuthSession && !adminAuthLocal) {
                console.log("Minimal Profile: User is NOT authenticated. Redirecting to auth.html");
                authStatusMessage.textContent = "Not authenticated. Redirecting...";
                authStatusMessage.style.color = 'var(--error)'; // Assuming --error is defined in profile.css
                window.location.replace("auth.html#login"); // Use replace
            } else {
                 console.log("Minimal Profile: User IS authenticated. Loading minimal page content.");
                 authStatusMessage.textContent = "Authentication successful!";
                 authStatusMessage.style.color = 'var(--success)'; // Assuming --success is defined in profile.css
                 // User is authenticated, they stay on this page.
                 // No other profile logic is included in this minimal version.

                 // --- Logout Functionality (Can keep this simple logout) ---
                  const logoutBtn = document.getElementById('logoutBtn');
                   if (logoutBtn) {
                       logoutBtn.addEventListener('click', function(e) {
                           e.preventDefault();
                           console.log("Minimal Profile: Logging out...");
                           // Clear relevant auth/user info from localStorage and sessionStorage
                           localStorage.removeItem('userAuthenticated');
                           sessionStorage.removeItem('userAuthenticated');
                           localStorage.removeItem('adminAuthenticated');
                           localStorage.removeItem('loggedInUsername'); // Clear username too
                           sessionStorage.removeItem('loggedInUsername');

                           // Redirect to auth.html after logout
                           window.location.replace("auth.html");
                       });
                   }
            }
             console.log("--- End Minimal Profile.html Auth Check ---");
        });
    </script>
</body>
</html>